-- MySQL Script generated by MySQL Workbench
-- 12/01/16 08:27:16
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema pharmabook
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema pharmabook
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `pharmabook` DEFAULT CHARACTER SET latin1 ;
USE `pharmabook` ;

-- -----------------------------------------------------
-- Table `pharmabook`.`classe_terapeutica`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pharmabook`.`classe_terapeutica` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `nome` VARCHAR(255) NULL DEFAULT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pharmabook`.`endereco`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pharmabook`.`endereco` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `cep` VARCHAR(255) NULL DEFAULT NULL,
  `logradouro` VARCHAR(255) NULL DEFAULT NULL,
  `numero` INT(11) NULL DEFAULT NULL,
  `complemento` VARCHAR(255) NULL DEFAULT NULL,
  `referencia` VARCHAR(255) NULL DEFAULT NULL,
  `bairro` VARCHAR(255) NULL DEFAULT NULL,
  `cidade` VARCHAR(255) NULL DEFAULT NULL,
  `estado` VARCHAR(255) NULL DEFAULT NULL,
  `pais` VARCHAR(255) NULL DEFAULT NULL,
  `dataCriacao` DATE NULL DEFAULT NULL,
  `dataAtualizacao` DATE NULL DEFAULT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pharmabook`.`farmacia`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pharmabook`.`farmacia` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `nome` VARCHAR(255) NOT NULL,
  `telefone` VARCHAR(255) NULL DEFAULT NULL,
  `dataCriacao` DATE NULL DEFAULT NULL,
  `dataAtualizacao` DATE NULL DEFAULT NULL,
  `endereco_id` INT(11) NOT NULL,
  PRIMARY KEY (`id`, `endereco_id`),
  INDEX `fk_Farmacia_Endereco_idx` (`endereco_id` ASC),
  CONSTRAINT `fk_Farmacia_Endereco`
    FOREIGN KEY (`endereco_id`)
    REFERENCES `pharmabook`.`endereco` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pharmabook`.`principio_ativo`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pharmabook`.`principio_ativo` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `nome` VARCHAR(255) NULL DEFAULT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pharmabook`.`laboratorio`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pharmabook`.`laboratorio` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `nome` VARCHAR(255) NULL DEFAULT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pharmabook`.`medicamento`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pharmabook`.`medicamento` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `ean` VARCHAR(255) NULL DEFAULT NULL,
  `cnpj` VARCHAR(255) NULL DEFAULT NULL,
  `ggrem` VARCHAR(255) NULL DEFAULT NULL,
  `registro` VARCHAR(255) NULL DEFAULT NULL,
  `nome_comercial` VARCHAR(255) NULL DEFAULT NULL,
  `composicao` VARCHAR(255) NULL DEFAULT NULL,
  `preco_fabrica` FLOAT NULL DEFAULT NULL,
  `preco_maximo_consumidor` FLOAT NULL DEFAULT NULL,
  `restricao_hospitalar` VARCHAR(255) NULL DEFAULT NULL,
  `laboratorio_id` INT(11) NOT NULL,
  `classe_terapeutica_id` INT(11) NOT NULL,
  `principio_ativo_id` INT(11) NOT NULL,
  PRIMARY KEY (`id`, `laboratorio_id`, `classe_terapeutica_id`, `principio_ativo_id`),
  INDEX `fk_medicamento_laboratorio1_idx` (`laboratorio_id` ASC),
  INDEX `fk_medicamento_classe_terapeutica1_idx` (`classe_terapeutica_id` ASC),
  INDEX `fk_medicamento_formula1_idx` (`principio_ativo_id` ASC),
  CONSTRAINT `fk_medicamento_classe_terapeutica1`
    FOREIGN KEY (`classe_terapeutica_id`)
    REFERENCES `pharmabook`.`classe_terapeutica` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_medicamento_formula1`
    FOREIGN KEY (`principio_ativo_id`)
    REFERENCES `pharmabook`.`principio_ativo` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_medicamento_laboratorio1`
    FOREIGN KEY (`laboratorio_id`)
    REFERENCES `pharmabook`.`laboratorio` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pharmabook`.`usuario`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pharmabook`.`usuario` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `nome` VARCHAR(255) NOT NULL,
  `sobrenome` VARCHAR(255) NULL,
  `email` VARCHAR(255) NOT NULL,
  `login` VARCHAR(255) NOT NULL,
  `senha` VARCHAR(255) NOT NULL,
  `dataCriacao` DATE NULL DEFAULT NULL,
  `dataAtualizacao` DATE NULL DEFAULT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pharmabook`.`medicamento_precificado`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pharmabook`.`medicamento_precificado` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `preco` DOUBLE NOT NULL,
  `dataCriacao` DATE NULL DEFAULT NULL,
  `dataAtualizacao` DATE NULL DEFAULT NULL,
  `farmacia_id` INT(11) NOT NULL,
  `medicamento_id` INT(11) NOT NULL,
  `usuario_id` INT(11) NOT NULL,
  PRIMARY KEY (`id`, `farmacia_id`, `medicamento_id`, `usuario_id`),
  INDEX `fk_medicamento_precificado_farmacia1_idx` (`farmacia_id` ASC),
  INDEX `fk_medicamento_precificado_medicamento1_idx` (`medicamento_id` ASC),
  INDEX `fk_medicamento_precificado_usuario1_idx` (`usuario_id` ASC),
  CONSTRAINT `fk_medicamento_precificado_farmacia1`
    FOREIGN KEY (`farmacia_id`)
    REFERENCES `pharmabook`.`farmacia` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_medicamento_precificado_medicamento1`
    FOREIGN KEY (`medicamento_id`)
    REFERENCES `pharmabook`.`medicamento` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_medicamento_precificado_usuario1`
    FOREIGN KEY (`usuario_id`)
    REFERENCES `pharmabook`.`usuario` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pharmabook`.`favorito`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pharmabook`.`favorito` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `usario_id` INT(11) NOT NULL,
  `medicamento_precificado_id` INT(11) NOT NULL,
  PRIMARY KEY (`id`, `usario_id`, `medicamento_precificado_id`),
  INDEX `fk_usario_has_medicamento_precificado_medicamento_precifica_idx` (`medicamento_precificado_id` ASC),
  INDEX `fk_usario_has_medicamento_precificado_usario1_idx` (`usario_id` ASC),
  CONSTRAINT `fk_usario_has_medicamento_precificado_medicamento_precificado1`
    FOREIGN KEY (`id`)
    REFERENCES `pharmabook`.`medicamento_precificado` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_usario_has_medicamento_precificado_usario1`
    FOREIGN KEY (`usario_id`)
    REFERENCES `pharmabook`.`usuario` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pharmabook`.`medicamento_pessoal`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pharmabook`.`medicamento_pessoal` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `quantidade` INT(11) NULL DEFAULT NULL,
  `validade` DATE NULL,
  `dataCriacao` DATE NULL,
  `dataAtualizacao` DATE NULL,
  `data_nova_compra` DATE NULL DEFAULT NULL,
  `usuario_id` INT(11) NOT NULL,
  `medicamento_precificado_id` INT(11) NOT NULL,
  PRIMARY KEY (`id`, `usuario_id`, `medicamento_precificado_id`),
  INDEX `fk_medicamento_pessoal_usuario1_idx` (`usuario_id` ASC),
  INDEX `fk_medicamento_pessoal_medicamento_precificado1_idx` (`medicamento_precificado_id` ASC),
  CONSTRAINT `fk_medicamento_pessoal_usuario1`
    FOREIGN KEY (`usuario_id`)
    REFERENCES `pharmabook`.`usuario` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_medicamento_pessoal_medicamento_precificado1`
    FOREIGN KEY (`medicamento_precificado_id`)
    REFERENCES `pharmabook`.`medicamento_precificado` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pharmabook`.`notificacao_nova_compra`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pharmabook`.`notificacao_nova_compra` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `mesagem` VARCHAR(255) NULL DEFAULT NULL,
  `data` DATE NULL DEFAULT NULL,
  `usuario_id` INT(11) NOT NULL,
  `medicamento_pessoal_id` INT(11) NOT NULL,
  PRIMARY KEY (`id`, `usuario_id`, `medicamento_pessoal_id`),
  INDEX `fk_notificacao_nova_compra_usuario1_idx` (`usuario_id` ASC),
  INDEX `fk_notificacao_nova_compra_medicamento_pessoal1_idx` (`medicamento_pessoal_id` ASC),
  CONSTRAINT `fk_notificacao_nova_compra_medicamento_pessoal1`
    FOREIGN KEY (`medicamento_pessoal_id`)
    REFERENCES `pharmabook`.`medicamento_pessoal` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_notificacao_nova_compra_usuario1`
    FOREIGN KEY (`usuario_id`)
    REFERENCES `pharmabook`.`usuario` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pharmabook`.`notificacao_promocao`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pharmabook`.`notificacao_promocao` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `mensagem` VARCHAR(45) NULL DEFAULT NULL,
  `data` DATE NULL DEFAULT NULL,
  `usuario_id` INT(11) NOT NULL,
  `medicamento_precificado_id` INT(11) NOT NULL,
  PRIMARY KEY (`id`, `usuario_id`, `medicamento_precificado_id`),
  INDEX `fk_notificacao_usuario1_idx` (`usuario_id` ASC),
  INDEX `fk_notificacao_promocao_medicamento_precificado1_idx` (`medicamento_precificado_id` ASC),
  CONSTRAINT `fk_notificacao_promocao_medicamento_precificado1`
    FOREIGN KEY (`id`)
    REFERENCES `pharmabook`.`medicamento_precificado` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_notificacao_usuario1`
    FOREIGN KEY (`usuario_id`)
    REFERENCES `pharmabook`.`usuario` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pharmabook`.`posologia`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pharmabook`.`posologia` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `dose` DOUBLE NULL DEFAULT NULL,
  `descricao` VARCHAR(255) NULL DEFAULT NULL,
  `periodicidade` INT NULL,
  `administracao_tipo` VARCHAR(255) NULL,
  `tipo_periodicidade` VARCHAR(255) NULL,
  `tipo_unidade_dose` VARCHAR(255) NULL,
  `medicamento_pessoal_id` INT(11) NOT NULL,
  `usuario_id` INT(11) NOT NULL,
  PRIMARY KEY (`id`, `medicamento_pessoal_id`, `usuario_id`),
  INDEX `fk_posologia_medicamento_pessoal1_idx` (`medicamento_pessoal_id` ASC),
  INDEX `fk_posologia_usuario1_idx` (`usuario_id` ASC),
  CONSTRAINT `fk_posologia_medicamento_pessoal1`
    FOREIGN KEY (`medicamento_pessoal_id`)
    REFERENCES `pharmabook`.`medicamento_pessoal` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_posologia_usuario1`
    FOREIGN KEY (`usuario_id`)
    REFERENCES `pharmabook`.`usuario` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
